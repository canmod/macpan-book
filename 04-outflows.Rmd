# Outflows

In compartmental modelling we typically want to balance each flow out of a boxes with an equal flow into another box. This is because individuals are simply changing their epidemiological status as they move between boxes, and the total number of individuals across the boxes remains constant.

```{r echo = FALSE}
DiagrammeR::grViz("digraph {
  graph [layout = dot, rankdir = LR]
  
  node [shape = rectangle]        
  S [label = 'S']
  I [label = 'I']
  
  # edge definitions with the node IDs
  S -> I
  }",
  height = 100, width = 200)
```

## Standard Inflow-Outflow Balance

McMasterPandemic makes it very easy to declare this standard balance between inflows and outflows to any model by simply adding `add_outflow` to your model definition pipeline.

```{r add_outflow}
sir = (init_model(
  params = c(beta = 0.1, gamma = 0.01, N = 100),
  state = c(S = 99, I = 1, R = 0),
  start_date = "2020-03-11",
  end_date = "2020-12-01"
)
 %>% add_rate("S", "I", ~ (I) * (beta) * (1/N))
 %>% add_rate("I", "R", ~ (gamma))
 %>% add_outflow
)
```

If we had not added the `add_outflow` line, the previous `add_rate` calls would have caused flows _into_ I from S and _into_ R from I. The `add_outflow` line adds flows _out of_ S to I and _out of_ I to R. A simple interpretation of the S to I rate without `add_outflow` is to imagine that S-individuals give birth to I-individuals. Because S-individuals do not die at childbirth, there is no outflow from the S box.

This interface design makes it very easy to enforce inflow-outflow balance. This ease of use contrasts with the standard practice of writing down difference or differential equations to define the model (e.g. POMP, STAN). This equation-style interface requires that the user make sure each inflow term in one equation is appropriately balanced by an outflow term in another equation. In McMasterPandemic you define the inflows, and then a single call of `add_outflow` automatically creates balancing outflows.

## Accumulators

Accumulator compartments are those that do not allow 
